    #run playwright tests
    - name: Run Playwright Tests
      id: run_tests
      run: |
        # Ensure pipefail is set so the exit status of the first command in a pipeline is used.
        set -o pipefail
        EXIT_CODE=0

        # Run the tests. If npx playwright test exits non-zero, capture its exit code.
        DISPLAY=:99 npx playwright test ${{ matrix.group.file }} \
          --project="Google Chrome" \
          --workers=1 \
          --headed \
          --reporter="list,json=./test-results/report.json" \
          2>&1 | tee test_output.txt || EXIT_CODE=$?

        echo "Test exit code: $EXIT_CODE"
        echo "exit-code=$EXIT_CODE" >> $GITHUB_OUTPUT

        # Check for flaky tests in the report
        if grep -q '"status": "flaky"' ./test-results/report.json; then
          echo "Flaky tests detected in ${{ matrix.group.file }}."
          exit 1
        fi

        # Exit with the captured test status
        exit $EXIT_CODE
      working-directory: ./Playwright-Automation
      continue-on-error: true
