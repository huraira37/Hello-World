import fs from 'fs';
import path from 'path';
import { globSync } from 'glob';

const files = globSync('../all-artifacts/Monocart-*/index.json');

console.log(`ğŸ§ª Found ${files.length} Monocart index.json file(s)`);

for (const file of files) {
  console.log('\n========================');
  console.log('ğŸ” Inspecting:', file);

  try {
    const content = JSON.parse(fs.readFileSync(file, 'utf-8'));

    if (Array.isArray(content)) {
      console.log('ğŸ“„ JSON is an array with length:', content.length);
    } else if (typeof content === 'object') {
      console.log('ğŸ“„ JSON is an object with keys:', Object.keys(content));
    } else {
      console.log('âš ï¸ JSON is not valid or unexpected structure.');
    }

  } catch (e) {
    console.log('âŒ Failed to parse JSON:', e.message);
  }
}


***********************************************************************************

    # âœ… Debug: Inspect the JSON structure inside Monocart reports
    - name: Debug: Inspect JSON file structure
      run: node debug-json.mjs
      working-directory: ./Playwright-Automation

    - name: Merge Monocart reports using monocart-reporter
      run: node merge-monocart.mjs
      working-directory: ./Playwright-Automation
